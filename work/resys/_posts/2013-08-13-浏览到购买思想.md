---
layout: post
title:  "浏览到购买"
date:   2013-08-13 19:03:11
category: resys
---
浏览到购买，购买还浏览，浏览还浏览，购买还购买 在一个算法中实现
-
**author: xiajun**</br>
-
常规实现:</br>
==
1.浏览到浏览常规做法是将浏览的商品使用itemBase 进行矩阵计算得出商品到商品的相似度</br>
2.购买还购买的得常规做法是将购买商品进行itembase 矩阵计算</br>

想法：
==
1.将用户购买的商品和浏览的商品放在一起计算矩阵
<table style="border-collapse: collapse;font-family: sans-serif;">
<tr style="height:35px">
<td style="width:40px;">
user
</td>
<td style="width:40px;">
c_item
</td>
<td style="width:40px;">
c_item
</td>
<td style="width:40px;">
c_item
</td>
<td style="width:40px;">
b_item
</td>
<td style="width:40px;">
item
</td>
</tr>
<tr style="height:35px">
<td style="width:40px;">
张三
</td>
<td style="width:40px;">
c_1001
</td>
<td style="width:40px;">
c_1007
</td>
<td style="width:40px;">
c_1008
</td>
<td style="width:40px;">
b_1005
</td>
<td style="width:40px;">
...
</td>
</tr>
<tr style="height:35px">
<td style="width:40px;">
李四
</td>
<td style="width:40px;">
c_1006
</td>
<td style="width:40px;">
c_1008
</td>
<td style="width:40px;">
c_1001
</td>
<td style="width:40px;">
b_1007
</td>
<td style="width:40px;">
...
</td>
</tr>
</table>
实现：
==
1.将用户的点击行为和购买行为进行区分</br>
2.将点击和购买数据进行糅合并使用mahout itembase进行矩阵计算</br>
(示例数据非计算所得)
<table style="border-collapse: collapse;font-family: sans-serif;">
<tr style="height:35px">
<td style="width:40px;">
</td>
<td style="width:40px;">
c_1001
</td>
<td style="width:40px;">
c_1005
</td>
<td style="width:40px;">
c_1006
</td>
<td style="width:40px;">
c_1007
</td>
<td style="width:40px;">
c_1008
</td>
<td style="width:40px;">
b_1005
</td>
</td>
<td style="width:40px;">
b_1007
</td>
</tr>
<tr style="height:35px">
<td style="width:40px;">
c_1001
</td>
<td style="width:40px;">
NAN
</td>
<td style="width:40px;">
0.1
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0.3
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0.2
</td>
<td style="width:40px;">
0.1
</td>
</tr>
<tr style="height:35px">
<td style="width:40px;">
c_1005
</td>
<td style="width:40px;">
0.03
</td>
<td style="width:40px;">
NAN
</td>
<td style="width:40px;">
0.2
</td>
<td style="width:40px;">
0.12
</td>
<td style="width:40px;">
0.004
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0
</td></tr>
<tr style="height:35px">
<td style="width:40px;">
c_1006
</td>
<td style="width:40px;">
0.2
</td>
<td style="width:40px;">
0.3
</td>
<td style="width:40px;">
NAN
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0.4
</td>
<td style="width:40px;">
0.1
</td>
<td style="width:40px;">
0.23
</td></tr>
<tr style="height:35px">
<td style="width:40px;">
c_1007
</td>
<td style="width:40px;">
0.4
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0.11
</td>
<td style="width:40px;">
NAN
</td>
<td style="width:40px;">
0.02
</td>
<td style="width:40px;">
0.32
</td>
<td style="width:40px;">
0.01
</td></tr>
<tr style="height:35px">
<td style="width:40px;">
c_1008
</td>
<td style="width:40px;">
0.14
</td>
<td style="width:40px;">
0.31
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0.3
</td>
<td style="width:40px;">
NAN
</td>
<td style="width:40px;">
0.2
</td>
<td style="width:40px;">
0.15
</td></tr>
<tr style="height:35px">
<td style="width:40px;">
b_1005
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0.13
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0.23
</td>
<td style="width:40px;">
0.2
</td>
<td style="width:40px;">
NAN
</td>
<td style="width:40px;">
0.01
</td>
</tr>
<tr style="height:35px">
<td style="width:40px;">
b_1007
</td>
<td style="width:40px;">
0.21
</td>
<td style="width:40px;">
0.1
</td>
<td style="width:40px;">
0.4
</td>
<td style="width:40px;">
0.3
</td>
<td style="width:40px;">
0
</td>
<td style="width:40px;">
0.2
</td>
<td style="width:40px;">
NAN
</td>
</tr>
</table>
3.根据以上结果可以看出
>c_1001和 c_1005,c_1007,b_1005,b_1007有相似度</br>
>分解结果:</br>
>[c_1001:{c_1005:0.1},{c_1007:0.3}] 就是浏览到浏览的结果</br>
>[c_1001:{b_1005:0.2},{b_1007:0.1}] 就是浏览的购买的结果</br>

>b_1005和 c_1005,c_1007,c_1008,b_1007有相似度</br>
>分解结果:</br>
>[b_1005:{c_1005:0.13},{c_1007:0.23},{c_1008:0.2}] 购买到浏览的结果</br>
>[b_1005:{b_1007:0.01}] 购买还购买结果

根据以上分析就可以得到四种结果

优化:
==
上面方法其实有很多不足的地方:</br>
1.当浏览数据过大并且很稀疏时会严重影响矩阵结果</br>
2.当很多用户只浏览不购买这时浏览到购买的结果就不好</br>
3.由于浏览数据比购买数据大很多所以购买到购买严重受影响</br>
>当浏览数据比较稀疏时可以用SVD降维处理或者限制每个用户最大使用多少个浏览记录</br>
>用户只浏览不购买可以将这部分用户剔除不过这样做会影响浏览到浏览的结果需要权衡</br>
>购买到购买受到影响的主要原因在于mahout itembase 在计算矩阵后需要输出指定个数的结果 比如 为一个</br>
>商品返回20个相似商品 很可能这20个都是购买到浏览的结果 购买到购买被远远排在了后面所以这时只能调大输出</br>
>结果数但这样无形中加大了矩阵的大小所以还的根据具体业务去权衡</br>